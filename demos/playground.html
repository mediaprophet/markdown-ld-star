<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Markdown-LD* Playground</title>
  <script src="../dist/index.browser.js"></script>
  <link rel="stylesheet" href="lcars.css">
</head>
<body>
  <h1>Markdown-LD* Playground</h1>
  <p>Experiment with Markdown-LD*: Parse to RDF formats or convert RDF to Markdown-LD*. Inspired by Star Trek's LCARS interface.</p>

  <div class="demo-container">
    <div class="demo-sidebar">
      <h3>Demo Files</h3>
      <button onclick="loadDemo('schema-org-sample.md')">Schema.org</button>
      <button onclick="loadDemo('rdf-star-sample.md')">RDF-Star</button>
      <button onclick="loadDemo('shacl-sample.md')">SHACL</button>
    </div>
    <div style="flex: 1;">
      <div class="tab">
        <button class="tablinks active" onclick="openTab(event, 'mdToRdf')">Markdown-LD* to RDF</button>
        <button class="tablinks" onclick="openTab(event, 'rdfToMd')">RDF to Markdown-LD*</button>
        <button class="tablinks" onclick="openTab(event, 'fetchUri')">Fetch URI to Markdown-LD*</button>
      </div>

      <div id="mdToRdf" class="tabcontent">
        <h2>Markdown-LD* to RDF</h2>
        <textarea id="mdInput" placeholder="Enter Markdown-LD* here..."></textarea>
        <select id="outputFormat">
          <option value="turtle">Turtle</option>
          <option value="jsonld">JSON-LD</option>
          <option value="rdfjson">RDF/JSON</option>
          <option value="jsonldstar">JSON-LD*</option>
        </select>
        <button onclick="parseMd()">Parse</button>
        <pre id="rdfOutput"></pre>
      </div>

      <div id="rdfToMd" class="tabcontent" style="display: none;">
        <h2>RDF to Markdown-LD*</h2>
        <textarea id="rdfInput" placeholder="Enter RDF here (Turtle, JSON-LD, etc.)..."></textarea>
        <select id="inputFormat">
          <option value="turtle">Turtle</option>
          <option value="jsonld">JSON-LD</option>
          <option value="rdfjson">RDF/JSON</option>
          <option value="jsonldstar">JSON-LD*</option>
          <option value="n3">N3</option>
          <option value="trig">TriG</option>
        </select>
        <button onclick="convertRdf()">Convert</button>
        <pre id="mdOutput"></pre>
      </div>

      <div id="fetchUri" class="tabcontent" style="display: none;">
        <h2>Fetch URI to Markdown-LD*</h2>
        <input type="text" id="uriInput" placeholder="Enter RDF URI (e.g., https://example.org/data.ttl)">
        <select id="uriFormat">
          <option value="turtle">Turtle</option>
          <option value="jsonld">JSON-LD</option>
          <option value="rdfjson">RDF/JSON</option>
          <option value="jsonldstar">JSON-LD*</option>
          <option value="n3">N3</option>
          <option value="trig">TriG</option>
        </select>
        <button onclick="fetchAndConvert()">Fetch & Convert</button>
        <pre id="uriOutput"></pre>
      </div>
    </div>
  </div>

  <script>
    function openTab(evt, tabName) {
      const tabcontent = document.getElementsByClassName("tabcontent");
      for (let i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
      }
      const tablinks = document.getElementsByClassName("tablinks");
      for (let i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
      }
      document.getElementById(tabName).style.display = "block";
      evt.currentTarget.className += " active";
    }

    async function loadDemo(file) {
      try {
        const response = await fetch(`demos/${file}`);
        if (!response.ok) throw new Error('Failed to load demo');
        const content = await response.text();
        document.getElementById('mdInput').value = content;
        openTab({ currentTarget: document.querySelector('.tablinks') }, 'mdToRdf');
        parseMd();
      } catch (e) {
        document.getElementById('rdfOutput').textContent = 'Error: ' + e.message;
      }
    }

    function parseMd() {
      const input = document.getElementById('mdInput').value;
      const format = document.getElementById('outputFormat').value;
      try {
        const result = MarkdownLDStar.parseMarkdownLD(input, { format });
        const output = typeof result.output === 'object' ? JSON.stringify(result.output, null, 2) : result.output;
        document.getElementById('rdfOutput').textContent = output;
      } catch (e) {
        document.getElementById('rdfOutput').textContent = 'Error: ' + e.message;
      }
    }

    async function convertRdf() {
      const input = document.getElementById('rdfInput').value;
      const format = document.getElementById('inputFormat').value;
      try {
        const md = await MarkdownLDStar.fromRDFToMarkdownLD(input, format);
        document.getElementById('mdOutput').textContent = md;
      } catch (e) {
        document.getElementById('mdOutput').textContent = 'Error: ' + e.message;
      }
    }

    async function fetchAndConvert() {
      const uri = document.getElementById('uriInput').value;
      const format = document.getElementById('uriFormat').value;
      try {
        const response = await fetch(uri);
        if (!response.ok) throw new Error('Fetch failed');
        const content = await response.text();
        const md = await MarkdownLDStar.fromRDFToMarkdownLD(content, format);
        document.getElementById('uriOutput').textContent = md;
      } catch (e) {
        document.getElementById('uriOutput').textContent = 'Error: ' + e.message;
      }
    }

    // Initialize first tab
    document.querySelector('.tablinks').className += ' active';
    document.getElementById('mdToRdf').style.display = 'block';
  </script>
</body>
</html>